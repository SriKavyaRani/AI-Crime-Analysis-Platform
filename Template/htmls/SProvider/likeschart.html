{% extends 'SProvider/Header.html' %}
{% block researchblock %}

<style>
    body {
        background-color: #FFFFFF;
    }
    
    .menu table {
        width: 100%;
        text-align: center;
    }
    
    .menu table td:hover {
        background: rgb(0,0,0);
    }
    
    .menu table td {
        background: #584b4f;
    }
    
    .menu table, .menu table th, .menu table td {
        border: 1px solid #ccc;
        border-collapse: collapse;
    }
    
    .menu table th, .menu table td {
        padding: 15px;
    }
    
    .topic h1 {
        color: white;
        padding: 2px;
        text-align: center;
        border-style: none;
        height: 100px;
        width: 1330px;
        float: left;
    }
    
    #chartContainer {
        width: 1020px;
        margin-left: 150px;
        margin-top: -354px;
        position: fixed;
    }
    
    .sidemenu {
        margin-top: 118px;
    }
</style>

<script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>

<script>
window.onload = function() {
    // Check if CanvasJS is loaded
    if (typeof CanvasJS === 'undefined') {
        console.error('CanvasJS library not loaded');
        return;
    }
    
    var chart = new CanvasJS.Chart("chartContainer", {
        animationEnabled: true,
        title: {
            text: ""
        },
        data: [{
            {% if chart_type == "rangeSplineArea" %}
                type: "rangeSplineArea",
            {% elif chart_type == "pie" %}
                type: "pie",
            {% elif chart_type == "spline" %}
                type: "spline",
            {% else %}
                type: "column",
            {% endif %}
            startAngle: 240,
            yValueFormatString: "##0.00\"%\"",
            indexLabel: "{label} {y}",
            dataPoints: [
                {% for o in form %}
                    {y: {{ o.dcount|default:0 }}, label: "{{ o.names|escapejs }}"}{% if not forloop.last %},{% endif %}
                {% empty %}
                    {y: 0, label: "No Data"}
                {% endfor %}
            ]
        }]
    });
    
    try {
        chart.render();
    } catch (error) {
        console.error('Chart rendering error:', error);
    }
}
</script>

<body>
    <br>
    <div class="topic">
        <div class="sidemenu">
            <h3 style="color:white;margin-left:60px;margin-top:100px;">&nbsp;</h3>
            <h3 style="color:white;margin-left:60px;margin-top:100px;">
                <br><br><br><br>
                <a href="{% url 'likeschart' 'bar' %}">View Bar Chart</a>
            </h3>
        </div>
        <div id="chartContainer" class="graph"></div>
    </div>
</body>

{% endblock %}